# Unbroken - Tactical Barbell Fitness Tracker

Unbroken is a React 18 + TypeScript + Vite web application for tracking fitness workouts using the Tactical Barbell methodology. It's a hybrid athlete tracker that manages workout blocks, exercises, and progress tracking with support for strength training, cardio, and periodization.

**Always reference these instructions first and fallback to search or bash commands only when you encounter unexpected information that does not match the info here.**

## Working Effectively

### Prerequisites and Setup
- Requires Node.js 18.0.0 or higher (Node.js 20+ recommended)
- npm comes with Node.js
- Uses Vite as the build tool and development server
- No additional system dependencies required

### Bootstrap, Build, and Test the Repository
1. **Install dependencies**:
   ```bash
   npm install
   ```
   - Takes ~30 seconds to complete
   - May show warnings about deprecated packages - this is normal
   - May show moderate security vulnerabilities - this is acceptable for development

2. **Type checking**:
   ```bash
   npm run type-check
   ```
   - Takes ~2 seconds
   - Shows TypeScript version warning but functions correctly
   - Must pass before committing changes

3. **Linting**:
   ```bash
   npm run lint
   ```
   - Takes ~1.3 seconds
   - Shows TypeScript version warning but functions correctly
   - Must pass before committing changes

4. **Auto-fix linting issues**:
   ```bash
   npm run lint:fix
   ```
   - Takes ~1.3 seconds
   - Automatically fixes code style issues

5. **Build for production**:
   ```bash
   npm run build
   ```
   - Takes ~5 seconds. Set timeout to 30+ seconds to be safe.
   - Runs TypeScript compilation followed by Vite build
   - Outputs to `dist/` directory
   - Must complete successfully before deploying

### Development Workflow
1. **Start development server**:
   ```bash
   npm run dev
   ```
   - Starts in ~200ms
   - Runs on http://localhost:5173
   - Hot reload enabled for instant feedback
   - Keep this running while developing

2. **Preview production build locally**:
   ```bash
   npm run preview
   ```
   - Runs production build locally on http://localhost:4173
   - Use this to test production builds before deployment

## Validation

### Manual Testing Requirements
**ALWAYS manually validate any changes via the web interface after making code modifications.**

#### Core User Scenarios to Test:
1. **Overview Page**: Navigate to the app and verify the main dashboard loads with current block info
2. **Workout Flow**: 
   - Click "Start Today's Workout"
   - Verify exercises display with correct weights and sets
   - Test warmup set completion buttons
   - Test working set weight adjustments
   - Verify "Complete Workout" functionality
3. **Settings Management**:
   - Click "Settings" tab
   - Test training plan management (add/remove blocks)
   - Verify exercise database updates (1RM values)
   - Test weight unit preferences (kg/lbs)
4. **History Tracking**:
   - Click "History" tab
   - Verify completed workouts appear (or empty state for new installs)

#### Browser Testing:
- Always test in a modern browser (Chrome, Firefox, Safari, Edge)
- Verify responsive design on different screen sizes
- Check for console errors in browser dev tools

### Pre-Commit Validation
**Always run these commands before committing changes:**
```bash
npm run lint && npm run type-check && npm run build
```
- This matches the CI pipeline requirements
- All commands must pass without errors
- The entire sequence takes ~8 seconds

## Deployment

### Cloudflare Pages (Production)
- **Framework preset**: Vite
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Node.js version**: 18 or higher
- Automatic deployment on pushes to main branch
- Manual deployment: build locally and upload `dist/` contents

### CI/CD Pipeline
- GitHub Actions workflow runs on every push and pull request
- Pipeline includes: dependency installation, linting, type checking, building, and artifact upload
- All steps must pass for PR approval
- Build artifacts are stored for 7 days

## Project Structure and Key Files

### Repository Root
```
Unbroken/
├── .github/            # GitHub Actions workflows and configurations
├── public/             # Static assets (vite.svg)
├── src/                # Source code
│   ├── App.tsx         # Main application component (800+ lines)
│   ├── main.tsx        # React application entry point
│   ├── index.css       # Global styles with Tailwind CSS
│   └── blockTemplates.ts # Workout block definitions and templates
├── dist/               # Build output (generated by npm run build)
├── index.html          # HTML template for the SPA
├── package.json        # Dependencies and npm scripts
├── vite.config.ts      # Vite build configuration
├── tsconfig.json       # TypeScript configuration
├── tailwind.config.js  # Tailwind CSS configuration
├── postcss.config.js   # PostCSS configuration for Tailwind
├── .eslintrc.cjs       # ESLint configuration
├── wrangler.jsonc      # Cloudflare Pages configuration
└── README.md           # Project documentation
```

### Key Application Components

#### Core Files to Understand:
- **`src/App.tsx`**: Main React component containing all application logic
  - State management for workouts, progress, settings
  - UI components for different views (overview, workout, history, settings)
  - Workout calculations and weight management
  - Block progression and exercise tracking

- **`src/blockTemplates.ts`**: Workout program definitions
  - Contains all training block templates (Endurance, Powerbuilding, Bodybuilding, Strength)
  - Defines workout structures, exercise progressions, and intensities
  - Used by App.tsx to generate daily workouts

#### Configuration Files:
- **`vite.config.ts`**: Build configuration, sets output directory to `dist/`
- **`tsconfig.json`**: TypeScript settings with strict mode enabled
- **`tailwind.config.js`**: CSS framework configuration for styling
- **`.eslintrc.cjs`**: Code quality rules and standards

## Technology Stack

- **React 18**: UI library with hooks and functional components
- **TypeScript**: Type safety and enhanced developer experience
- **Vite**: Fast build tool and development server
- **Tailwind CSS**: Utility-first CSS framework for styling
- **ESLint**: Code linting and quality enforcement
- **Lucide React**: Icon library for UI elements

## Common Development Tasks

### Adding New Workout Blocks
1. Edit `src/blockTemplates.ts` to add new block definitions
2. Update the block selection dropdown in the Settings component
3. Test the new block in the application interface
4. Verify weight calculations work correctly

### Modifying Exercise Database
1. Exercise 1RM values are stored in application state
2. Weight calculations are based on percentages of 1RM values
3. Warmup sets are automatically calculated from working weights
4. Always test weight calculations after modifications

### Styling Changes
1. Use Tailwind CSS utility classes for consistent styling
2. Custom CSS can be added to `src/index.css` if needed
3. Follow the existing color scheme and responsive design patterns
4. Test on different screen sizes

### State Management
1. Application uses React's useState hook for state management
2. No external state management library (Redux, Zustand, etc.)
3. State includes: current plan, progress, settings, completed workouts
4. Local storage is used for persistence

## Troubleshooting Common Issues

### Build Failures
- Ensure all TypeScript errors are resolved with `npm run type-check`
- Check ESLint errors with `npm run lint`
- Clear `node_modules` and reinstall with `npm install` if dependencies are corrupted

### Development Server Issues
- If port 5173 is busy, Vite will automatically use the next available port
- Check for console errors in browser dev tools
- Restart dev server if hot reload stops working

### TypeScript Warnings
- The application uses TypeScript 5.9.2 which shows compatibility warnings with ESLint
- These warnings are safe to ignore as the code functions correctly
- Consider updating TypeScript and ESLint dependencies if warnings become problematic

### Deployment Issues on Cloudflare Pages
- Ensure build command is set to `npm run build`
- Verify output directory is set to `dist`
- Check that Node.js version is 18 or higher in Cloudflare settings